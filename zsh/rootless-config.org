#+TITLE: Configure Zsh in a rootless host
#+AUTHOR: Rafael Ito
#+PROPERTY: header-args :tangle
#+PROPERTY: header-args:sh :tangle rootless-config.sh
#+DESCRIPTION: config for Zsh from source
#+STARTUP: showeverything
#+auto_tangle: t

* Table of contents :toc_1:
- [[#set-dir-and-path-env-var][Set dir and PATH env var]]
- [[#install-m4][Install m4]]
- [[#install-autoconf][Install autoconf]]
- [[#install-automake][Install automake]]
- [[#ncurses][ncurses]]
- [[#install-zsh][Install Zsh]]
- [[#copy-zsh-dotfiles][Copy Zsh dotfiles]]
- [[#install-oh-my-zsh][Install Oh My Zsh]]

* Set dir and PATH env var
#+begin_src sh
cd
mkdir local-build
export PATH=/home/rafael.ito/local-build/bin:$PATH
BUILD_PATH=$HOME/local-build
#+end_src
* Install m4
#+begin_src sh
cd
wget ftp.gnu.org/gnu/m4/m4-latest.tar.gz
tar -xvzf m4-latest.tar.gz
rm m4-latest.tar.gz
cd m4-*
./configure --prefix=$BUILD_PATH
make
make install
#+end_src
* Install autoconf
#+begin_src sh
cd
wget https://ftp.gnu.org/gnu/autoconf/autoconf-latest.tar.gz
tar -xvzf autoconf-*
rm autoconf-latest.tar.gz
cd autoconf-*
./configure --prefix=$BUILD_PATH
make
make install
#+end_src
* Install automake
#+begin_src sh
cd
wget https://ftp.gnu.org/gnu/automake/automake-1.17.tar.gz
tar -xvzf automake-1.17.tar.gz
rm automake-1.17.tar.gz
cd automake-1.17
./configure --prefix=$BUILD_PATH
make
make install
#+end_src
* ncurses
#+begin_src sh
cd
wget https://ftp.gnu.org/gnu/ncurses/ncurses-6.5.tar.gz
tar -xvzf ncurses-6.5.tar.gz
rm ncurses-6.5.tar.gz
cd ncurses-6.5
./configure --prefix=$BUILD_PATH --with-termlib --with-shared --with-versioned-syms
make
make install
ln -s /home/rafael.ito/local-build/lib/libncursesw.so.6 /home/rafael.ito/local-build/lib/libtinfo.so.5
echo "export LD_LIBRARY_PATH=$HOME/local-build/lib" >> ~/.bashrc
echo "export LD_LIBRARY_PATH=$HOME/local-build/lib" >> ~/.config/zsh/.zshenv
#+end_src
* Install Zsh
#+begin_src sh
cd
wget -O install_zsh_without_root.sh https://gist.githubusercontent.com/mgbckr/b8dc6d7d228e25325b6dfaa1c4018e78/raw/8b3f254b4e3a70d18d09bca804a660c560f583ae/install_zsh_on_sherlock.sh
sed -i 's/\(ZSH_INSTALL_DIR=$HOME\/\)services\/zsh/\1local-build\/bin\/zsh/g' install_zsh_without_root.sh
sed -i 's/\(--prefix=\)$ZSH.*$/\1$HOME\/local-build/g' install_zsh_without_root.sh
sed -i 's/robbyrussell\/oh-my-zsh/ohmyzsh\/ohmyzsh/g' install_zsh_without_root.sh
bash install_zsh_without_root.sh
#+end_src
* Copy Zsh dotfiles
#+begin_src sh
cd
ZDOTDIR=$HOME/.config/zsh
mkdir -p $ZDOTDIR
wget -O $ZDOTDIR/.zshrc https://raw.githubusercontent.com/ito-rafael/dotfiles/refs/heads/master/zsh/zshrc
wget -O $ZDOTDIR/.zshenv https://raw.githubusercontent.com/ito-rafael/dotfiles/refs/heads/master/zsh/zshenv
wget -O $HOME/.zshenv https://raw.githubusercontent.com/ito-rafael/dotfiles/refs/heads/master/zsh/zshenv_home
#+end_src
* Install Oh My Zsh
#+begin_src sh
ZSH=$HOME/.config/oh-my-zsh sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
#+end_src

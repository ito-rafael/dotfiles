#+title: Arch install guide
#+author: Rafael Ito
#+description: Arch install guide
#+startup: showeverything

* Preparation
** Documents
sources:
https://wiki.archlinux.org/index.php/Installation_guide
https://itsfoss.com/install-arch-linux/
** Boot from the live USB
download image from:
https://www.archlinux.org/download/

verify signature: (replace <VERSION> accordingly)
#+begin_src sh
gpg --keyserver-options auto-key-retrieve --verify archlinux-<VERSION>-x86_64.iso.sig
#+end_src

copy image to a USB stick: (replace "sdx" accordingly)
#+begin_src sh
dd bs=4M if=path/to/archlinux.iso of=/dev/sdx status=progress oflag=sync
#+end_src

boot from the USB flash drive

* Live environment
** increase font size
#+begin_src sh
setfont /usr/share/kbd/consolefonts/latarcyrheb-sun32.psfu.gz
#+end_src
** configure network device
#+begin_src sh
iw dev
rfkill list
rfkill unblock wifi
ip link set wlp1s0 up
iw dev wlp1s0 scan | less
ip link set wlp1s0 down
iw dev wlp1s0 set type ibss
ip link set wlp1s0 up
#+end_src
** set up Wi-Fi connection
replace "SSID" and "PASSWD" accordingly
#+begin_src sh
wpa_passphrase "SSID" "PASSWD" > /etc/wpa_supplicant/SSID.conf
wpa_supplicant -c /etc/wpa_supplicant/SSID.conf -i wlp1s0
wpa_supplicant -B -c /etc/wpa_supplicant/SSID.conf -i wlp1s0
dhclient wlp1s0
#+end_src
** update the system clock
#+begin_src sh
timedatectl set-ntp true
#+end_src
** Disk partitioning
#+begin_src sh
fdisk -l
fdisk /dev/sdX
#+end_src
*** delete partitions
|---------+--------------------|
|   <c>   |        <c>         |
| command |    description     |
|---------+--------------------|
|    d    | delete a partition |
| <ENTER> |  partition number  |
|---------+--------------------|
repeat if necessary
*** create EFI partition
|---------+-------------------------|
|   <c>   |           <c>           |
| command |       description       |
|---------+-------------------------|
|    n    |   add a new partition   |
|    2    |    partition number     |
| <ENTER> |      first sector       |
|  +260M  |       last sector       |
|    Y    |  remove the signature   |
|---------+-------------------------|
|    t    | change a partition type |
|    2    |    partition number     |
|    1    |       EFI System        |
|---------+-------------------------|
# update 05/2021: EFI partition type "ef"
*** create / partition
|---------+-------------------------|
|   <c>   |           <c>           |
| command |       description       |
|---------+-------------------------|
|    n    |   add a new partition   |
|    3    |    partition number     |
| <ENTER> |      first sector       |
|  +100G  |       last sector       |
|    Y    |  remove the signature   |
|---------+-------------------------|
|    t    | change a partition type |
|    3    |    partition number     |
|   24    |   Linux root (x86-64)   |
|---------+-------------------------|
# update 05/2021: Linux root (x86-64) "83"
# update 07/2022: Linux root (x86-64) "23"

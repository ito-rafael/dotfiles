#+TITLE: Configs for LibreOffice Calc
#+AUTHOR: Rafael Ito
#+DESCRIPTION: configs for LibreOffice Calc
#+STARTUP: showeverything
#+auto_tangle: t

* Table of Contents :toc:
- [[#macro][Macro]]
  - [[#paint-cells][Paint cells]]
- [[#keybindings][Keybindings]]

* Macro
:PROPERTIES:
:header-args: :tangle macros
:END:
1. Tools > Macros > Organize Macros > Basic
2. Paste the macro below into "My Macros"
** Paint cells
*** Function
#+begin_src conf
Sub ToggleCellColor(color As Long)
    Dim oCellRange As Object
    Dim oCell As Object
    Dim i As Integer, j As Integer

    oCellRange = ThisComponent.CurrentSelection

    If oCellRange.supportsService("com.sun.star.sheet.SheetCellRange") Then
        For i = 0 To oCellRange.Rows.getCount() - 1
            For j = 0 To oCellRange.Columns.getCount() - 1
                oCell = oCellRange.getCellByPosition(j, i)
                If oCell.CellBackColor = color Then
                    oCell.CellBackColor = -1  ' Transparent
                Else
                    oCell.CellBackColor = color
                End If
            Next j
        Next i
    ElseIf oCellRange.supportsService("com.sun.star.sheet.SheetCell") Then
        If oCellRange.CellBackColor = color Then
            oCellRange.CellBackColor = -1
        Else
            oCellRange.CellBackColor = color
        End If
    End If
End Sub
#+end_src
*** Colors
**** Yellow
#+begin_src conf
Sub PaintCellYellow
    ToggleCellColor(RGB(255, 255, 166))
End Sub
#+end_src
**** Green
#+begin_src conf
Sub PaintCellGreen
    ToggleCellColor(RGB(175, 208, 149))
End Sub
#+end_src
**** Red
#+begin_src conf
Sub PaintCellRed
    ToggleCellColor(RGB(255, 166, 166))
End Sub
#+end_src
**** Gray
#+begin_src conf
Sub PaintCellGray
    ToggleCellColor(RGB(204, 204, 204))
End Sub
#+end_src
**** Transparent
#+begin_src conf
Sub PaintCellTransparent
    ToggleCellColor(RGB(255, 255, 255))
End Sub
#+end_src
* Keybindings
1. Tools > Customize > Keyboard
2. Assign a shortcut to a function
|----------+----------+------------------------+-----------------------------------------------------------------------------------------------|
| shortcut | category | description            | function                                                                                      |
|----------+----------+------------------------+-----------------------------------------------------------------------------------------------|
| Alt+M    | macro    | paint cell Transparent | vnd.sun.star.script:Standard.Module1.PaintCellTransparent?language=Basic&location=application |
| Alt+N    | macro    | paint cell Yellow      | vnd.sun.star.script:Standard.Module1.PaintCellYellow?language=Basic&location=application      |
| Alt+E    | macro    | paint cell Green       | vnd.sun.star.script:Standard.Module1.PaintCellGreen?language=Basic&location=application       |
| Alt+I    | macro    | paint cell Red         | vnd.sun.star.script:Standard.Module1.PaintCellRed?language=Basic&location=application         |
| Alt+O    | macro    | paint cell Gray        | vnd.sun.star.script:Standard.Module1.PaintCellGray?language=Basic&location=application        |
|----------+----------+------------------------+-----------------------------------------------------------------------------------------------|
